# 实验内容   
自适应采样率。但如何自适应呢？本实验就是要搞定如何自适应。  

# 自适应采样率思想
## ~~思路1~~   
假设平衡采样率为 0.5，基分类器数量为 15。   
那么采样间隔为 0.5/15 = 0.03，采样率起止为[0.47, 0.53]。
但这样的就有问题啊：采样率越高，说明比较平衡，你这个采样间隔反而比较大。不应该啊，应该是不平衡率比较大时，采样间隔也比较大。

最终决定：抛弃该算法

好烦啊，之前的实验数据又要抛弃了。 

## 思路2
采样间隔应该遵循这样的规律：   
1、不平衡率越高，采样间隔应该越来越小 
2、采样间隔不能 0< 或 >1   

我发现的规律：当不平衡比越大时，微小的采样率变化会引起样本数量变化很大。   
当不平衡率为 40 时，采样率为 0.025。   

那这样的话，肯定要用到 log 函数。   

采样间隔为：ir*(1/logIR) = 1/(IR*logIR)   
设计思路：
log 取对数保证了不平衡率越高，采样间隔变化越来越小。取倒数就是不平衡率越高，采样间隔越小的意思。   
1/logIR 再乘以平衡采样率，再进一步缩小采样间隔到合理范围。   
   

例如：不平衡率为5，平衡采样率为 0.2，那么采样间隔为 0.08。
不平衡率为 40，平衡采样率为 0.025，那么采样间隔为 0.005。  

灵感：采样间隔有了，难道就一定要以平衡采样率为中心点嘛？可以1/4的位置，也可以1/5的位置，是不是突然多了很多实验，哈哈。

灵感：极大不平衡时怎么办呢？通常这种情况下负样本只有寥寥的几个。该怎么办呢？把这个少数类分错了，acc仍然可以达到99%。
直接复制？那只要有一个分错了，不就全部分错了？要是分对了，那不就全对了？
只有一个样本该怎么办啊！！！

当样本数量少于30时，就进行数据增强。数据维度太高，怎么进行增强啊。




# 实验目的
验证猜想，我认为“自适应采样率”能取得比较好的结果。   

# 实验数据
自适应采样率集成分类器   
ASBC = AdaSamplingBaggingClassifier

## 平衡采样率为 1/2 点位
### yeast-0-6 388/90=4.32
|  评价指标  | ASBC |
|  ----     | ----             |
|f1score    |0.9156 ±0.0126    |
|auc        |0.8420 ±0.0300    |
|gmean      |0.6453 ±0.0650    |

### ecoli-4 301/35=8.60
为啥 gmean 为 0 呢？    

|  评价指标  | ASBC |
|  ----     | ----             |
|f1score    |0.9448 ±0.0100    |
|auc        |0.9065 ±0.0236   |
|gmean      |0.0143 ±0.0625    |

### vowel-0 900/90=10.00
|  评价指标  | ASBC |
|  ----     | ----             |
|f1score    |0.9524 ±0.0048    |
|auc        |0.9466 ±0.0211   |
|gmean      |0.0000 ±0.0000    |




## 平衡采样率为 1/3 点位
### yeast-0-6 388/90=4.32
|  评价指标  | ASBC |
|  ----     | ----             |
|f1score    |0.9149 ±0.0170   |
|auc        |0.8439 ±0.0309    |
|gmean      |0.5691 ±0.1492    |




## 平衡采样率为 1/4 点位
### yeast-0-6 388/90=4.32
|  评价指标  | ASBC |
|  ----     | ----             |
|f1score    |0.9177 ±0.0081   |
|auc        |0.8522 ±0.0245    |
|gmean      |0.6355 ±0.0497    |




## 平衡采样率为 1/5 点位
### yeast-0-6 388/90=4.32
|  评价指标  | ASBC |
|  ----     | ----             |
|f1score    |0.9173 ±0.0130   |
|auc        |0.8559 ±0.0316    |
|gmean      |0.6538 ±0.0805    |


# 画图展示区别
箱线图，用来选择平衡采样率位点位置。












# 实验结论
f1score和auc表现不掉队，gmean就差劲了。   
可以再加点其它的东西，凸显工作量

# 出现的 Bug
## KNN pred_prob()函数返回值只有一个数值？
正常情况是有两个数值的。
原因：训练该 KNN 的样本中只有一个类别，抽样导致的。
解决办法：平衡抽样，保证有两个类别   
- [ ] 补充图片